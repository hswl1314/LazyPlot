% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/draw_oplsda.R
\name{draw_oplsda}
\alias{draw_oplsda}
\title{Draw OPLS-DA Plot with Statistics}
\usage{
draw_oplsda(df, var_names = NULL, Group = NULL, group_labels = NULL,
                   colors = NULL, x_limits = NULL, y_limits = NULL,
                   show_stats = TRUE, point_size = 3,
                   ellipse_alpha = 0.2, ellipse_level = 0.95)
}
\arguments{
\item{df}{A data frame containing the variables for OPLS-DA analysis}

\item{var_names}{Optional character vector specifying the names of variables to be used}

\item{Group}{Optional character vector specifying the levels of groups}

\item{group_labels}{Optional character vector for custom group labels}

\item{colors}{Optional vector of colors for groups}

\item{x_limits}{Optional numeric vector of length 2 specifying x-axis limits}

\item{y_limits}{Optional numeric vector of length 2 specifying y-axis limits}

\item{show_stats}{Logical, whether to show model statistics (default: TRUE)}

\item{point_size}{Numeric, size of points in the plot (default: 3)}

\item{ellipse_alpha}{Numeric, transparency of confidence ellipses (default: 0.2)}

\item{ellipse_level}{Numeric, confidence level for ellipses (default: 0.95)}
}
\value{
A list containing:
\itemize{
\item plot - ggplot object of the OPLS-DA plot
\item model - OPLS-DA model object
\item scores - data frame of score values
\item vip - data frame of VIP scores
}
}
\description{
Creates an OPLS-DA plot with confidence ellipses and statistics
for visualizing group differences in multivariate data.
}
\examples{
\dontrun{
# Create example data
set.seed(123)
n_samples <- 60
example_data <- data.frame(
  SampleID = paste0("Sample_", 1:n_samples),
  Group = rep(c("Control", "Treatment"), each = 30)
)

# Add 10 simulated metabolite variables
for(i in 1:10) {
  example_data[paste0("Metabolite_", i)] <- c(
    rnorm(30, mean = 10, sd = 2),  # Control group
    rnorm(30, mean = 15, sd = 2)   # Treatment group
  )
}

# Basic usage
result <- draw_oplsda(example_data)

# Custom colors and labels
result <- draw_oplsda(example_data,
                     colors = c("blue", "red"),
                     group_labels = c("Control Group", "Treatment Group"))
}
}
